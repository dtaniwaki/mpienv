#!/bin/bash

if [ ! -f $HOME/.mpienv/shims ]; then
    G=$HOME/.mpienv/version_global
    if [ -f $G ]; then
        ln -s $(cat $G) $HOME/.mpienv/shims
    fi
fi

export PATH=$HOME/.mpienv/shims/bin:${PATH:-}
export LD_LIBRARY_PATH=$HOME/.mpienv/shims/lib:$HOME/.mpienv/shims/lib64:${LD_LIBRARY_PATH:-}

function mpienv() {
    command="$1"
    shift

    case "$command" in
        "use" )
            {
                python ~/.mpienv/mpienv_use.py $*
            }
            ;;
        "add" )
            {
                python ~/.mpienv/mpienv_add.py $*
            }
            ;;
        "list" )
            {
                python ~/.mpienv/mpienv_list.py $*
            }
            ;;
        "info" )
            {
                python ~/.mpienv/mpienv_info.py $*
            }
            ;;
        "autodiscover" )
            {
                python ~/.mpienv/mpienv_autodiscover.py $*
            }
            ;;
        * )
            echo "mpienv [ERROR]: Unknown command '$command'"
            ;;
    esac
}
